<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teacher Dashboard - School Management System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .section-header h2 {
            font-size: 22px;
            color: #2c3e50;
        }

        .section-header a {
            text-decoration: none;
            font-size: 14px;
            color: #3498db;
            transition: color 0.3s;
        }

        .section-header a:hover {
            color: #1d6fa5;
        }

        /* Recent Activity */
        .recent-activity {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        .activity-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .activity-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #eaeaea;
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 40px;
            height: 40px;
            background: #3498db;
            color: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            margin-right: 15px;
        }

        .activity-info h4 {
            margin: 0;
            font-size: 16px;
            font-weight: 600;
        }

        .activity-info p {
            margin: 2px 0 0;
            font-size: 14px;
            color: #666;
        }

        .activity-time {
            margin-left: auto;
            font-size: 12px;
            color: #999;
        }

        /* Today's Classes */
        .classes-section {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        .class-item {
            border-bottom: 1px solid #eaeaea;
            padding: 15px 0;
        }

        .class-item:last-child {
            border-bottom: none;
        }

        .class-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .class-title {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
        }

        .class-time {
            font-size: 14px;
            color: #999;
        }

        .class-content {
            font-size: 14px;
            margin-top: 5px;
            color: #555;
        }
        
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <i class="fas fa-chalkboard-teacher fa-2x"></i>
            <h3>Teacher Portal</h3>
        </div>
        <div class="sidebar-menu">
            <ul>
                <li><a href="#" class="active" onclick="showDashboard()"><i class="fas fa-tachometer-alt"></i> <span>Dashboard</span></a></li>
                <li><a href="#" onclick="showClasses()"><i class="fas fa-users"></i> <span>My Classes</span></a></li>
                <li><a href="#" onclick="showAssignments()"><i class="fas fa-tasks"></i> <span>Assignments</span></a></li>
                <li><a href="#" onclick="showStudents()"><i class="fas fa-user-graduate"></i> <span>Students</span></a></li>
                <li><a href="#" onclick="showAnnouncements()"><i class="fas fa-bullhorn"></i> <span>Announcements</span></a></li>
            </ul>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Dashboard Section -->
        <div id="dashboard-section">
            <!-- Header -->
            <div class="header">
                <h1>Teacher Dashboard</h1>
                <div class="user-profile" onclick="showProfile()">
                    <img src="https://ui-avatars.com/api/?name=John+Doe&background=3a86ff&color=fff" alt="Teacher User">
                    <div class="user-info">
                        <h4>John Doe</h4>
                        <p>Mathematics Teacher</p>
                    </div>
                </div>
            </div>

            <!-- Cards -->
            <div class="cards-container">
                <div class="card">
                    <div class="card-header">
                        <div>
                            <h3 id="students-count">0</h3>
                            <p>Students</p>
                        </div>
                        <div class="card-icon students">
                            <i class="fas fa-user-graduate"></i>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div>
                            <h3 id="classes-count">0</h3>
                            <p>Classes</p>
                        </div>
                        <div class="card-icon classes">
                            <i class="fas fa-users"></i>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div>
                            <h3 id="assignments-count">0</h3>
                            <p>Assignments</p>
                        </div>
                        <div class="card-icon assignments">
                            <i class="fas fa-tasks"></i>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div>
                            <h3 id="announcements-count">0</h3>
                            <p>Announcements</p>
                        </div>
                        <div class="card-icon announcements-card">
                            <i class="fas fa-bullhorn"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="recent-activity">
                <div class="section-header">
                    <h2>Recent Activity</h2>
                    <a href="#">View All</a>
                </div>
                <ul class="activity-list" id="activity-list">
                    <li class="activity-item">
                        <div class="activity-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <div class="activity-info">
                            <h4>New Assignment Created</h4>
                            <p>Algebra Homework for Grade 9</p>
                        </div>
                        <div class="activity-time">2 hours ago</div>
                    </li>
                    <li class="activity-item">
                        <div class="activity-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="activity-info">
                            <h4>Assignment Graded</h4>
                            <p>Geometry Quiz for Grade 10</p>
                        </div>
                        <div class="activity-time">1 day ago</div>
                    </li>
                    <li class="activity-item">
                        <div class="activity-icon">
                            <i class="fas fa-bullhorn"></i>
                        </div>
                        <div class="activity-info">
                            <h4>New Announcement</h4>
                            <p>Parent-Teacher Meeting Scheduled</p>
                        </div>
                        <div class="activity-time">2 days ago</div>
                    </li>
                </ul>
            </div>

            <!-- Upcoming Classes -->
            <div class="classes-section">
                <div class="section-header">
                    <h2>Today's Classes</h2>
                    <a href="#">View All</a>
                </div>
                <div class="class-item">
                    <div class="class-header">
                        <div class="class-title">Grade 9 - Algebra</div>
                        <div class="class-time">9:00 AM - 10:00 AM</div>
                    </div>
                    <div class="class-content">
                        Topic: Quadratic Equations | Room: 201
                    </div>
                </div>
                <div class="class-item">
                    <div class="class-header">
                        <div class="class-title">Grade 10 - Geometry</div>
                        <div class="class-time">11:00 AM - 12:00 PM</div>
                    </div>
                    <div class="class-content">
                        Topic: Trigonometry | Room: 205
                    </div>
                </div>
                <div class="class-item">
                    <div class="class-header">
                        <div class="class-title">Grade 11 - Calculus</div>
                        <div class="class-time">1:00 PM - 2:00 PM</div>
                    </div>
                    <div class="class-content">
                        Topic: Derivatives | Room: 210
                    </div>
                </div>
            </div>
        </div>

        <!-- Classes Section -->
        <div id="classes-section" style="display: none;">
            <div class="header">
                <h1>My Classes</h1>
                <button class="btn btn-add" onclick="showAddClassModal()">Add Class</button>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Class Name</th>
                        <th>Grade Level</th>
                        <th>Schedule</th>
                        <th>Room</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="classes-table-body">
                    
                </tbody>
            </table>
        </div>

        <!-- Assignments Section -->
        <div id="assignments-section" style="display: none;">
            <div class="header">
                <h1>Assignments</h1>
                <button class="btn btn-add" onclick="showAddAssignmentModal()">Add Assignment</button>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Title</th>
                        <th>Class</th>
                        <th>Due Date</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="assignments-table-body">
                    
                </tbody>
            </table>
        </div>

        <!-- Students Section -->
        <div id="students-section" style="display: none;">
            <div class="header">
                <h1>My Students</h1>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Class</th>
                        <th>Grade</th>
                        <th>Email</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="students-table-body">
                    
                </tbody>
            </table>
        </div>

        <!-- Announcements Section -->
        <div id="announcements-section" style="display: none;">
            <div class="header">
                <h1>Announcements</h1>
                <button class="btn btn-add" onclick="showAddAnnouncementModal()">Add Announcement</button>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Title</th>
                        <th>Date</th>
                        <th>Class</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="announcements-table-body">
                    
                </tbody>
            </table>
        </div>
    </div>

    <!-- Add Class Modal -->
    <div id="class-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="class-modal-title">Add New Class</h2>
                <button class="close-btn" onclick="closeModal('class-modal')">&times;</button>
            </div>
            <form id="class-form">
                <input type="hidden" id="class-id">
                <div class="form-group">
                    <label for="class-name">Class Name</label>
                    <input type="text" id="class-name" required>
                </div>
                <div class="form-group">
                    <label for="class-grade">Grade Level</label>
                    <select id="class-grade" required>
                        <option value="">Select Grade</option>
                        <option value="Grade 9">Grade 9</option>
                        <option value="Grade 10">Grade 10</option>
                        <option value="Grade 11">Grade 11</option>
                        <option value="Grade 12">Grade 12</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="class-schedule">Schedule</label>
                    <input type="text" id="class-schedule" placeholder="Mon/Wed 9:00-10:00" required>
                </div>
                <div class="form-group">
                    <label for="class-room">Room Number</label>
                    <input type="text" id="class-room" required>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" onclick="closeModal('class-modal')">Cancel</button>
                    <button type="submit" class="btn">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Assignment Modal -->
    <div id="assignment-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="assignment-modal-title">Add New Assignment</h2>
                <button class="close-btn" onclick="closeModal('assignment-modal')">&times;</button>
            </div>
            <form id="assignment-form">
                <input type="hidden" id="assignment-id">
                <div class="form-group">
                    <label for="assignment-title">Title</label>
                    <input type="text" id="assignment-title" required>
                </div>
                <div class="form-group">
                    <label for="assignment-class">Class</label>
                    <select id="assignment-class" required>
                        <option value="">Select Class</option>
                        <option value="1">Grade 9 - Algebra</option>
                        <option value="2">Grade 10 - Geometry</option>
                        <option value="3">Grade 11 - Calculus</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="assignment-due">Due Date</label>
                    <input type="date" id="assignment-due" required>
                </div>
                <div class="form-group">
                    <label for="assignment-description">Description</label>
                    <textarea id="assignment-description" required></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" onclick="closeModal('assignment-modal')">Cancel</button>
                    <button type="submit" class="btn">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Announcement Modal -->
    <div id="announcement-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="announcement-modal-title">Add New Announcement</h2>
                <button class="close-btn" onclick="closeModal('announcement-modal')">&times;</button>
            </div>
            <form id="announcement-form">
                <input type="hidden" id="announcement-id">
                <div class="form-group">
                    <label for="announcement-title">Title</label>
                    <input type="text" id="announcement-title" required>
                </div>
                <div class="form-group">
                    <label for="announcement-class">Class</label>
                    <select id="announcement-class">
                        <option value="0">All Classes</option>
                        <option value="1">Grade 9 - Algebra</option>
                        <option value="2">Grade 10 - Geometry</option>
                        <option value="3">Grade 11 - Calculus</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="announcement-date">Date</label>
                    <input type="date" id="announcement-date" required>
                </div>
                <div class="form-group">
                    <label for="announcement-content">Content</label>
                    <textarea id="announcement-content" required></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-cancel" onclick="closeModal('announcement-modal')">Cancel</button>
                    <button type="submit" class="btn">Save</button>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        // API Configuration
        const API_BASE_URL = '/api';
        const TEACHER_ID = 1; // In a real app, this would come from authentication

        // DOM Elements
        const elements = {
            dashboardSection: document.getElementById('dashboard-section'),
            classesSection: document.getElementById('classes-section'),
            assignmentsSection: document.getElementById('assignments-section'),
            studentsSection: document.getElementById('students-section'),
            announcementsSection: document.getElementById('announcements-section'),
            // Add other DOM elements as needed
        };

        // Current Teacher Data
        const currentTeacher = {
            id: TEACHER_ID,
            name: "John Doe",
            subject: "Mathematics"
        };

        // Utility Functions
        const utils = {
            formatDate: (dateString) => {
                const options = { year: 'numeric', month: 'short', day: 'numeric' };
                return new Date(dateString).toLocaleDateString(undefined, options);
            },
            
            formatTimeAgo: (dateString) => {
                const date = new Date(dateString);
                const now = new Date();
                const diffSeconds = Math.floor((now - date) / 1000);
                
                if (diffSeconds < 60) return 'Just now';
                if (diffSeconds < 3600) return `${Math.floor(diffSeconds/60)} minutes ago`;
                if (diffSeconds < 86400) return `${Math.floor(diffSeconds/3600)} hours ago`;
                if (diffSeconds < 604800) return `${Math.floor(diffSeconds/86400)} days ago`;
                return utils.formatDate(dateString);
            },
            
            showModal: (modalId) => {
                document.getElementById(modalId).style.display = 'flex';
            },
            
            closeModal: (modalId) => {
                document.getElementById(modalId).style.display = 'none';
            },
            
            showToast: (message, type = 'success') => {
                const toast = document.createElement('div');
                toast.className = `toast toast-${type}`;
                toast.innerHTML = `
                    <div class="toast-content">
                        <span class="close-toast" onclick="this.parentElement.parentElement.remove()">&times;</span>
                        ${message}
                    </div>
                `;
                document.body.appendChild(toast);
                
                setTimeout(() => toast.remove(), 5000);
            },
            
            handleApiError: (error) => {
                console.error('API Error:', error);
                utils.showToast(error.message || 'An error occurred', 'error');
                throw error;
            }
        };

        // API Service
        const apiService = {
            get: async (endpoint) => {
                try {
                    const response = await fetch(`${API_BASE_URL}${endpoint}`);
                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    return await response.json();
                } catch (error) {
                    utils.handleApiError(error);
                }
            },
            
            post: async (endpoint, data) => {
                try {
                    const response = await fetch(`${API_BASE_URL}${endpoint}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    return await response.json();
                } catch (error) {
                    utils.handleApiError(error);
                }
            },
            
            put: async (endpoint, data) => {
                try {
                    const response = await fetch(`${API_BASE_URL}${endpoint}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(data)
                    });
                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    return await response.json();
                } catch (error) {
                    utils.handleApiError(error);
                }
            },
            
            delete: async (endpoint) => {
                try {
                    const response = await fetch(`${API_BASE_URL}${endpoint}`, {
                        method: 'DELETE'
                    });
                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    return await response.json();
                } catch (error) {
                    utils.handleApiError(error);
                }
            }
        };

        // Data Service
        const dataService = {
            getDashboardData: async () => {
                return {
                    counts: await apiService.get(`/tdashboard/counts?teacherId=${TEACHER_ID}`),
                    activities: await apiService.get(`/tactivities?teacherId=${TEACHER_ID}`),
                    classes: await apiService.get(`/tclasses/today?teacherId=${TEACHER_ID}`)
                };
            },
            
            getClasses: async () => {
                return await apiService.get(`/tclasses?teacherId=${TEACHER_ID}`);
            },
            
            getClass: async (id) => {
                return await apiService.get(`/tclasses/${id}`);
            },
            
            saveClass: async (classData) => {
                const endpoint = classData.id ? `/tclasses/${classData.id}` : '/tclasses';
                const method = classData.id ? apiService.put : apiService.post;
                return await method(endpoint, classData);
            },
            
            deleteClass: async (id) => {
                return await apiService.delete(`/tclasses/${id}`);
            },
            
            getAssignments: async () => {
                return await apiService.get(`/tassignments?teacherId=${TEACHER_ID}`);
            },
            
            getAssignment: async (id) => {
                return await apiService.get(`/tassignments/${id}`);
            },
            
            saveAssignment: async (assignmentData) => {
                const endpoint = assignmentData.id ? `/tassignments/${assignmentData.id}` : '/tassignments';
                const method = assignmentData.id ? apiService.put : apiService.post;
                return await method(endpoint, assignmentData);
            },
            
            deleteAssignment: async (id) => {
                return await apiService.delete(`/tassignments/${id}`);
            },
            
            getStudents: async () => {
                const classes = await dataService.getClasses();
                const students = [];
                
                for (const cls of classes) {
                    const classStudents = await apiService.get(`/sclasses/${cls.id}/students`);
                    students.push(...classStudents.map(s => ({ ...s, class_name: cls.name })));
                }
                
                return students;
            },
            
            getStudent: async (id) => {
                return await apiService.get(`/students/${id}`);
            },
            
            getAnnouncements: async () => {
                return await apiService.get(`/announcements?userId=${TEACHER_ID}&userType=teacher`);
            },
            
            getAnnouncement: async (id) => {
                return await apiService.get(`/announcements/${id}`);
            },
            
            saveAnnouncement: async (announcementData) => {
                const endpoint = announcementData.id ? `/announcements/${announcementData.id}` : '/announcements';
                const method = announcementData.id ? apiService.put : apiService.post;
                return await method(endpoint, announcementData);
            },
            
            deleteAnnouncement: async (id) => {
                return await apiService.delete(`/announcements/${id}`);
            }
        };

        // UI Components
        const uiComponents = {
            showDashboard: async () => {
                try {
                    // Show loading state
                    elements.dashboardSection.innerHTML = '<div class="loading">Loading dashboard...</div>';
                    
                    // Hide other sections
                    document.querySelectorAll('.main-content > div').forEach(section => {
                        section.style.display = 'none';
                    });
                    elements.dashboardSection.style.display = 'block';
                    
                    // Load data
                    const data = await dataService.getDashboardData();
                    
                    // Update counts
                    document.getElementById('students-count').textContent = data.counts.students || 0;
                    document.getElementById('classes-count').textContent = data.counts.classes || 0;
                    document.getElementById('assignments-count').textContent = data.counts.assignments || 0;
                    document.getElementById('announcements-count').textContent = data.counts.announcements || 0;
                    
                    // Update activities
                    const activityList = document.getElementById('activity-list');
                    activityList.innerHTML = data.activities.slice(0, 3).map(activity => `
                        <li class="activity-item">
                            <div class="activity-icon">
                                <i class="fas ${activity.action.includes('Assignment') ? 'fa-tasks' : 
                                                activity.action.includes('Announcement') ? 'fa-bullhorn' : 
                                                'fa-info-circle'}"></i>
                            </div>
                            <div class="activity-info">
                                <h4>${activity.action}</h4>
                                <p>${activity.details}</p>
                            </div>
                            <div class="activity-time">${utils.formatTimeAgo(activity.created_at)}</div>
                        </li>
                    `).join('');
                    
                    // Update today's classes
                    const todayClasses = document.querySelector('#dashboard-section .classes-section');
                    todayClasses.innerHTML = `
                        <div class="section-header">
                            <h2>Today's Classes</h2>
                            <a href="#" onclick="uiComponents.showClasses(); return false;">View All</a>
                        </div>
                        ${data.classes.length ? data.classes.map(cls => `
                            <div class="class-item">
                                <div class="class-header">
                                    <div class="class-title">${cls.name}</div>
                                    <div class="class-time">${cls.schedule}</div>
                                </div>
                                <div class="class-content">
                                    Topic: ${cls.topic || 'Not specified'} | Room: ${cls.room_number || 'Not specified'}
                                </div>
                            </div>
                        `).join('') : '<p>No classes scheduled for today</p>'}
                    `;
                    
                } catch (error) {
                    console.error('Failed to load dashboard:', error);
                    elements.dashboardSection.innerHTML = '<div class="error">Failed to load dashboard data</div>';
                }
            },
            
            showClasses: async () => {
                try {
                    // Show loading state
                    elements.classesSection.innerHTML = '<div class="loading">Loading classes...</div>';
                    
                    // Hide other sections
                    document.querySelectorAll('.main-content > div').forEach(section => {
                        section.style.display = 'none';
                    });
                    elements.classesSection.style.display = 'block';
                    
                    // Load data
                    const classes = await dataService.getClasses();
                    
                    // Update table
                    const tbody = document.getElementById('classes-table-body');
                    tbody.innerHTML = classes.map(cls => `
                        <tr>
                            <td>${cls.id}</td>
                            <td>${cls.name}</td>
                            <td>${cls.grade_level}</td>
                            <td>${cls.schedule || 'Not scheduled'}</td>
                            <td>${cls.room_number || 'Not assigned'}</td>
                            <td>${cls.student_count || 0}</td>
                            <td>
                                <button class="action-btn view-btn" onclick="uiComponents.viewClass(${cls.id})">View</button>
                                <button class="action-btn edit-btn" onclick="uiComponents.editClass(${cls.id})">Edit</button>
                            </td>
                        </tr>
                    `).join('');
                    
                } catch (error) {
                    console.error('Failed to load classes:', error);
                    elements.classesSection.innerHTML = '<div class="error">Failed to load classes data</div>';
                }
            },
            
            showAddClassModal: () => {
                document.getElementById('class-modal-title').textContent = 'Add New Class';
                document.getElementById('class-form').reset();
                document.getElementById('class-id').value = '';
                utils.showModal('class-modal');
            },
            
            editClass: async (id) => {
                try {
                    const cls = await dataService.getClass(id);
                    document.getElementById('class-modal-title').textContent = 'Edit Class';
                    document.getElementById('class-id').value = cls.id;
                    document.getElementById('class-name').value = cls.name;
                    document.getElementById('class-grade').value = cls.grade_level;
                    document.getElementById('class-schedule').value = cls.schedule;
                    document.getElementById('class-room').value = cls.room_number;
                    utils.showModal('class-modal');
                } catch (error) {
                    console.error('Failed to load class:', error);
                    utils.showToast('Failed to load class details', 'error');
                }
            },
            
            viewClass: async (id) => {
                try {
                    const cls = await dataService.getClass(id);
                    alert(`Class: ${cls.name}\nGrade: ${cls.grade_level}\nSchedule: ${cls.schedule}\nRoom: ${cls.room_number}\nStudents: ${cls.student_count || 0}`);
                } catch (error) {
                    console.error('Failed to load class:', error);
                    utils.showToast('Failed to load class details', 'error');
                }
            },
            
            // Similar methods for assignments, students, announcements...
            // (Implementation follows the same pattern as classes)
            
            // Initialize the application
            init: () => {
                // Set up navigation
                document.querySelectorAll('.sidebar-menu a').forEach(item => {
                    item.addEventListener('click', function() {
                        document.querySelectorAll('.sidebar-menu a').forEach(i => i.classList.remove('active'));
                        this.classList.add('active');
                    });
                });
                
                // Set up form submissions
                document.getElementById('class-form').addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const formData = {
                        id: document.getElementById('class-id').value || null,
                        name: document.getElementById('class-name').value,
                        grade_level: document.getElementById('class-grade').value,
                        schedule: document.getElementById('class-schedule').value,
                        room_number: document.getElementById('class-room').value,
                        teacher_id: TEACHER_ID
                    };
                    
                    try {
                        await dataService.saveClass(formData);
                        utils.showToast(`Class ${formData.id ? 'updated' : 'added'} successfully!`);
                        utils.closeModal('class-modal');
                        uiComponents.showClasses();
                        uiComponents.showDashboard();
                    } catch (error) {
                        console.error('Failed to save class:', error);
                        utils.showToast(`Failed to save class: ${error.message}`, 'error');
                    }
                });
                
                // Set up other form submissions similarly...
                
                // Initialize profile
                document.querySelector('.user-info h4').textContent = currentTeacher.name;
                document.querySelector('.user-info p').textContent = `${currentTeacher.subject} Teacher`;
                
                // Load initial view
                uiComponents.showDashboard();
            }
        };

        // Initialize the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            uiComponents.init();
        });
    </script>
    
    </body>
    </html>